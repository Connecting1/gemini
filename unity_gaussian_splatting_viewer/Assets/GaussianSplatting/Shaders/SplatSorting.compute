// SPDX-License-Identifier: MIT
// GPU sorting compute shader - requires wave operations
// Separated from SplatUtilities.compute for platform compatibility

#define GROUP_SIZE 1024

// DeviceRadixSort kernels - these require wave operations
#pragma multi_compile __ KEY_UINT KEY_INT KEY_FLOAT
#pragma multi_compile __ PAYLOAD_UINT PAYLOAD_INT PAYLOAD_FLOAT
#pragma multi_compile __ SHOULD_ASCEND
#pragma multi_compile __ SORT_PAIRS
#pragma multi_compile __ VULKAN

// Only compile these kernels on platforms that support wave operations
// WebGL and some Android devices do not support these features
#if !defined(SHADER_API_WEBGL) && !defined(SHADER_API_GLES3) && !defined(SHADER_API_GLES)

#pragma kernel InitDeviceRadixSort
#pragma kernel Upsweep
#pragma kernel Scan
#pragma kernel Downsweep

// GPU sorting needs wave ops
#pragma require wavebasic
#pragma require waveballot
#pragma use_dxc

#include "DeviceRadixSort.hlsl"

#endif // !WEBGL && !GLES
